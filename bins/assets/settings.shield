[@SETTINGS]
{
    token: 
    interface: ens3
    monitor_port: 3023
    cs_ssh_port: 3024
    api_port: 80
    max_pps: 7500
    max_connections: 10
    max_con_per_port: 2
    auto_reset_rules: true
    auto_add_rules: true
}

[@PERSONAL_RULES]
{
    sudo iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
    sudo iptables -A INPUT -p tcp --dport 80 -m hashlimit --hashlimit-mode srcip --hashlimit-above 20/min --hashlimit-burst 5 --hashlimit-srcmask 32 --hashlimit-name http-limits -j DROP
    sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
    iptables -N OPENVPN_TRAFFIC
    iptables -A OPENVPN_TRAFFIC -p udp --dport 5051 -m limit --limit 100/s --limit-burst 200 -j ACCEPT
    iptables -A INPUT -p udp --dport 5051 -j OPENVPN_TRAFFIC
    sudo iptables -A INPUT -p udp -j DROP
    sudo iptables -A OUTPUT -p udp -j DROP
    sudo iptables -A INPUT -m string --string "P��" --algo bm -j DROP
    sudo iptables -A INPUT -m string --string "P" --algo bm -j DROP
}

[@PROTECTED_IPS]
{

}

// Add service ports in-use
// PORT/SERVICE_NAME/PROTOCOL/RESTART_COMMAND/MAX_CON/MAX_PPS/FILTER/DROP
//  80 ; APACHE     ;   TCP  ;  RESTART_CMD  ;  0    ;   0   ; true ; true
//
// USE 0 AS MAX_CON && MAX_PPS TO DISABLE FILTER/DROP ON THE PORT
[@PROTECTED_SERVICES]
{
    80;APACHE;TCP;service apache2 restart;0;0;true;true
    5051;OPENVPN;TCP;service openvpn restart;40;true;false
}